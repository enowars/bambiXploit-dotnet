name: Publish

on:
  release:
    types: [published]
  push:

jobs:
  release:
    name: Release
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Setup dotnet
        uses: actions/setup-dotnet@v1
      - name: Test
        run: dotnet test --no-restore --verbosity normal
      - name: Build Release
        run: | 
           dotnet publish -c Release --self-contained true -p:PublishSingleFile=true -p:IncludeAllContentForSelfExtract=true -r win-x64
           dotnet publish -c Release --self-contained true -p:PublishSingleFile=true -p:IncludeAllContentForSelfExtract=true -r linux-x64
      - name: Tree
        run: tree ./Bambixploit/bin/Release
#      - name: Publish
#        uses: softprops/action-gh-release@v1
#        with:
#          files: "App*"
#        env:
#          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
