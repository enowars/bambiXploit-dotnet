namespace Bambixploit
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Threading.Tasks;

    public static class ExploitTemplates
    {
        public static readonly string HttpTemplate = @"#!/usr/bin/env python3

import sys
import requests

TARGET = sys.argv[1]

session = requests.Session()

# Some CTFs publish information ('flag hints') which help you getting individual flags (e.g. the usernames of users that deposited flags).
# Bambi CTF flag hints:
# 

foo = s.get(f'http://{TARGET}:8000/bar?x=5')
";

        public static readonly string BinaryTemplate = @"#!/usr/bin/env python3
import sys
import requests

TARGET = sys.argv[1]

# hic sunt dracones
";

        public static void PrintTemplate(ExploitTemplate template)
        {
            switch (template)
            {
            case ExploitTemplate.Http:
                Console.Write(HttpTemplate);
                break;
            case ExploitTemplate.Binary:
                Console.Write(BinaryTemplate);
                break;
            default:
                throw new InvalidOperationException();
            }
        }
    }
}
